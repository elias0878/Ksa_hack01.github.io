<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net https://unpkg.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src * data:;">
    <title>OSINT ULTIMATE PRO - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.min.css" rel="stylesheet">
    <style>
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØµÙ…ÙŠÙ… */
        body {
            background-color: #121212;
        }
        .cyber-card {
            background: #212529;
            border: 1px solid #343a40;
            border-radius: 15px;
            transition: transform 0.3s ease;
        }
        .cyber-card:hover {
            transform: translateY(-5px);
        }
        .hacker-terminal {
            background: #000;
            color: #0f0;
            font-family: 'Courier New', monospace;
            min-height: 200px;
            max-height: 60vh;
            overflow-y: auto; 
            border: 1px solid #0d6efd;
            padding: 10px;
        }
        #threatMap {
            height: 400px;
            background: #000;
            border-radius: 15px;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0d6efd;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .alert { position: relative; }
        .alert .close {
            position: absolute;
            top: 0;
            right: 0;
            padding: 2px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="cyber-card p-4 mb-5">
            <h1 class="text-center mb-4">ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… OSINT Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
            
            <!-- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
            <ul class="nav nav-tabs mb-4" id="mainTabs">
                <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#ipAnalysis">ØªØ­Ù„ÙŠÙ„ IP</a></li>
                <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#domainIntel">Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª</a></li>
                <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a></li>
            </ul>

            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
            <div class="tab-content">
                <!-- ØªØ­Ù„ÙŠÙ„ IP -->
                <div class="tab-pane fade show active" id="ipAnalysis">
                    <div class="row g-4">
                        <div class="col-md-4">
                            <div class="cyber-card p-3">
                                <h5 class="mb-3">ğŸ” Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹</h5>
                                <input type="text" class="form-control bg-dark text-light mb-3" 
                                       id="ipInput" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† IP" required>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="runFullIPAnalysis()">Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
                                    <button class="btn btn-outline-secondary" onclick="clearResults()">Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
                                </div>
                                <div class="loader mt-3" id="ipLoader"></div>
                                <div class="hacker-terminal mt-3" id="ipHistory"></div>
                            </div>
                        </div>
                        
                        <div class="col-md-8">
                            <div class="cyber-card p-3">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <h5>ğŸŒ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</h5>
                                        <div class="hacker-terminal" id="geoData"></div>
                                        <div id="threatMap" class="mt-3"></div>
                                    </div>
                                    <div class="col-md-6">
                                        <h5>ğŸ›¡ï¸ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª</h5>
                                        <div class="hacker-terminal" id="threatData"></div>
                                        <div class="mt-3" id="threatChartContainer">
                                            <canvas id="threatChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… -->
                <div class="tab-pane fade" id="settings">
                    <div class="cyber-card p-3">
                        <h5 class="mb-4">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</h5>
                        <div class="mb-3">
                            <label class="form-label">Ù…ÙØªØ§Ø­ VirusTotal</label>
                            <input type="text" class="form-control bg-dark text-light" 
                                   id="vtKey" autocomplete="off" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Ù…ÙØªØ§Ø­ AbuseIPDB</label>
                            <input type="text" class="form-control bg-dark text-light" 
                                   id="abuseKey" autocomplete="off" required>
                        </div>
                        <button class="btn btn-primary" onclick="saveSettings()">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                        <button class="btn btn-danger ms-2" onclick="resetSettings()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        class OSINTApp {
            constructor() {
                this.settings = JSON.parse(localStorage.getItem('osintSettings')) || {
                    apis: {
                        virusTotal: '',
                        abuseIPDB: ''
                    }
                };
                this.map = null;
                this.chart = null;
                this.init();
            }

            init() {
                this.loadSettings();
                this.initMap();
                this.setupEventListeners();
            }

            loadSettings() {
                document.getElementById('vtKey').value = this.settings.apis.virusTotal;
                document.getElementById('abuseKey').value = this.settings.apis.abuseIPDB;
            }

            saveSettings() {
                this.settings.apis.virusTotal = document.getElementById('vtKey').value;
                this.settings.apis.abuseIPDB = document.getElementById('abuseKey').value;
                localStorage.setItem('osintSettings', JSON.stringify(this.settings));
                this.showAlert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            }

            initMap() {
                this.map = L.map('threatMap').setView([24.774265, 46.738586], 5);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(this.map);
            }

            setupEventListeners() {
                document.getElementById('ipInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') runFullIPAnalysis();
                });
            }

            showAlert(message, type = 'danger') {
                const alert = document.createElement('div');
                alert.className = `alert alert-${type} mt-3`;
                alert.textContent = message;
                const closeBtn = document.createElement('span');
                closeBtn.innerHTML = '&times;';
                closeBtn.className = 'close';
                closeBtn.onclick = () => alert.remove();
                alert.appendChild(closeBtn);
                document.querySelector('.tab-content').prepend(alert);
                setTimeout(() => alert.remove(), 5000);
            }
        }

        class IPAnalyzer {
            constructor(ip) {
                this.ip = ip;
                this.validation = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.{1}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.{1}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.{1}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            }

            async fullAnalysis() {
                if (!this.validateIP()) throw new Error('Ø¹Ù†ÙˆØ§Ù† IP ØºÙŠØ± ØµØ§Ù„Ø­');
                try {
                    const [geo, threat] = await Promise.all([
                        this.getGeoData(),
                        this.getThreatData()
                    ]);
                    return { geoData: geo, threatData: threat };
                } catch (error) {
                    throw new Error(`ÙØ´Ù„ Ø§Ù„ØªØ­Ù„ÙŠÙ„: ${error.message}`);
                }
            }

            validateIP() {
                return this.validation.test(this.ip);
            }

            async getGeoData() {
                const response = await axios.get(`https://ipapi.co/${this.ip}/json/`);
                return response.data;
            }

            async getThreatData() {
                const results = {};
                // VirusTotal
                if (app.settings.apis.virusTotal) {
                    const vtResponse = await axios.get(`https://www.virustotal.com/api/v3/ip_addresses/${this.ip}`, {
                        headers: { 'x-apikey': app.settings.apis.virusTotal }
                    });
                    results.virusTotal = vtResponse.data;
                }
                // AbuseIPDB
                if (app.settings.apis.abuseIPDB) {
                    const abuseResponse = await axios.get('https://api.abuseipdb.com/api/v2/check', {
                        params: { ipAddress: this.ip },
                        headers: { 'Key': app.settings.apis.abuseIPDB }
                    });
                    results.abuseIPDB = abuseResponse.data;
                }
                return results;
            }
        }

        const app = new OSINTApp();

        async function runFullIPAnalysis() {
            const ip = document.getElementById('ipInput').value.trim();
            if (!ip) return app.showAlert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† IP');
            try {
                toggleLoader(true);
                const analyzer = new IPAnalyzer(ip);
                const results = await analyzer.fullAnalysis();
                displayGeoData(results.geoData);
                displayThreatData(results.threatData);
                updateMap(results.geoData);
                updateChart(results.threatData);
                addToHistory(ip);
            } catch (error) {
                app.showAlert(error.message);
            } finally {
                toggleLoader(false);
            }
        }

        function displayGeoData(data) {
            const geoElement = document.getElementById('geoData');
            geoElement.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
        }

        function displayThreatData(data) {
            const threatElement = document.getElementById('threatData');
            threatElement.innerHTML = Object.entries(data)
                .map(([source, info]) => `
                    <div class="threat-item mb-3">
                        <h6>${source}</h6>
                        <pre>${JSON.stringify(info, null, 2)}</pre>
                    </div>
                `).join('');
        }

        function updateMap(geoData) {
            if (geoData.latitude && geoData.longitude) {
                app.map.setView([geoData.latitude, geoData.longitude], 8);
                L.marker([geoData.latitude, geoData.longitude]).addTo(app.map).bindPopup(`
                    <b>Ø§Ù„Ø¨Ù„Ø¯:</b> ${geoData.country_name}<br>
                    <b>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</b> ${geoData.city}<br>
                    <b>Ø§Ù„Ù…Ø²ÙˆØ¯:</b> ${geoData.org}
                `).openPopup();
            }
        }

        function updateChart(data) {
            const ctx = document.getElementById('threatChart');
            if (app.chart) app.chart.destroy();
            const threatLevels = Object.keys(data).map(source => {
                return {
                    label: source,
                    value: data[source].data?.attributes?.last_analysis_stats?.malicious || 0
                };
            });
            app.chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: threatLevels.map(item => item.label),
                    datasets: [{
                        label: 'Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯',
                        data: threatLevels.map(item => item.value),
                        backgroundColor: '#0d6efd'
                    }]
                }
            });
        }

        function toggleLoader(show) {
            document.getElementById('ipLoader').style.display = show ? 'block' : 'none';
        }

        function addToHistory(ip) {
            const historyElement = document.getElementById('ipHistory');
            const entry = document.createElement('div');
            entry.className = 'history-entry mb-2';
            entry.innerHTML = `<span class="text-primary">${ip}</span> <small class="text-muted">(${new Date().toLocaleString()})</small>`;
            historyElement.prepend(entry);
        }

        function clearResults() {
            document.getElementById('geoData').innerHTML = '';
            document.getElementById('threatData').innerHTML = '';
            if (app.chart) app.chart.destroy();
            app.map.setView([24.774265, 46.738586], 5);
            app.showAlert('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬', 'success');
        }

        function resetSettings() {
            localStorage.removeItem('osintSettings');
            document.getElementById('vtKey').value = '';
            document.getElementById('abuseKey').value = '';
            app.settings = { apis: { virusTotal: '', abuseIPDB: '' } };
            app.showAlert('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', 'warning');
        }
    </script>
</body>
</html>
