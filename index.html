<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ©</title>
    <style>
        :root {
            --primary: #2ecc71;
            --danger: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
        }

        body {
            font-family: 'Tahoma', sans-serif;
            background: var(--dark);
            color: var(--light);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: #34495e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
        }

        .permission-box {
            background: #27ae60;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 30px;
        }

        .data-section {
            margin: 25px 0;
            padding: 20px;
            background: #2c3e50;
            border-radius: 10px;
        }

        .sensitive-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .data-card {
            background: #3b4a5e;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }

        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            margin: 10px;
            transition: all 0.3s;
        }

        button.danger {
            background: var(--danger);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .warning {
            color: var(--danger);
            text-align: center;
            padding: 15px;
            border: 2px solid currentColor;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="permission-box">
            <h2>Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <p>Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ø£ØºØ±Ø§Ø¶ ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙÙ‚Ø· ÙˆÙ„Ø§ ØªØ®Ø²Ù† Ø£ÙŠ Ø¨ÙŠØ§Ù†Ø§Øª</p>
            <button onclick="startDataCollection()">âœ… Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø¡</button>
            <button class="danger" onclick="deleteAllData()">âŒ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>

        <div class="warning" id="warningMessage"></div>

        <div class="data-section" id="emailSection">
            <h3>ğŸ“§ Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h3>
            <div class="sensitive-data" id="emailList"></div>
        </div>

        <div class="data-section" id="phoneSection">
            <h3>ğŸ“± Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡ÙˆØ§ØªÙ</h3>
            <div class="sensitive-data" id="phoneList"></div>
        </div>

        <div class="data-section" id="otherDataSection">
            <h3>ğŸ” Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø®Ø±Ù‰ Ù…Ø­ØªÙ…Ù„Ø©</h3>
            <div class="sensitive-data" id="otherDataList"></div>
        </div>
    </div>

    <script>
        // ØªØ¹Ø¨ÙŠØ±Ø§Øª Ø¹Ø§Ø¯ÙŠØ© Ù„Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
        const patterns = {
            email: /\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,
            phone: /\b(?:\+?966|0)?5[0-9]{8}\b/g,
            token: /\b[a-f0-9]{32,}\b/gi,
            creditCard: /\b(?:\d[ -]*?){13,16}\b/g
        };

        async function startDataCollection() {
            try {
                // Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„ÙˆØµÙˆÙ„
                const hasPermission = await requestCookiePermission();
                if (!hasPermission) return;

                // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­Ù„ÙŠÙ„Ù‡Ø§
                const cookies = parseCookies();
                const sensitiveData = analyzeData(cookies);

                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                displayResults(sensitiveData);
            } catch (error) {
                showWarning('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!');
            }
        }

        async function requestCookiePermission() {
            return new Promise((resolve) => {
                const warning = document.getElementById('warningMessage');
                try {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ù‚Ø±Ø§Ø¡Ø© ÙƒÙˆÙƒÙŠØ² Ù„ØªÙØ¹ÙŠÙ„ Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø°Ù†
                    const test = document.cookie;
                    resolve(true);
                } catch (error) {
                    warning.innerHTML = 'ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„! ÙŠØ±Ø¬Ù‰ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø°Ù† ÙŠØ¯ÙˆÙŠÙ‹Ø§ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØµÙØ­';
                    resolve(false);
                }
            });
        }

        function parseCookies() {
            return document.cookie.split(';').reduce((acc, cookie) => {
                const [name, value] = cookie.split('=').map(s => s.trim());
                acc[name] = decodeURIComponent(value);
                return acc;
            }, {});
        }

        function analyzeData(cookies) {
            const results = {
                emails: new Set(),
                phones: new Set(),
                tokens: new Set(),
                creditCards: new Set(),
                others: []
            };

            Object.entries(cookies).forEach(([name, value]) => {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª
                const foundEmails = value.match(patterns.email);
                if (foundEmails) foundEmails.forEach(e => results.emails.add(e));

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø±Ù‚Ø§Ù… Ù‡ÙˆØ§ØªÙ
                const foundPhones = value.match(patterns.phone);
                if (foundPhones) foundPhones.forEach(p => results.phones.add(p));

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ø£Ø®Ø±Ù‰
                if (patterns.token.test(value)) results.tokens.add(value);
                if (patterns.creditCard.test(value)) results.creditCards.add(value);
                
                // Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø§Ù…Ø©
                if (value.length > 40 && !results.tokens.has(value)) {
                    results.others.push({ name, value: value.slice(0, 30) + '...' });
                }
            });

            return results;
        }

        function displayResults(data) {
            displaySection('emailList', Array.from(data.emails));
            displaySection('phoneList', Array.from(data.phones));
            displayOtherData(data);
        }

        function displaySection(containerId, items) {
            const container = document.getElementById(containerId);
            container.innerHTML = items.length > 0 
                ? items.map(i => `<div class="data-card">${i}</div>`).join('')
                : '<div class="data-card">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>';
        }

        function displayOtherData(data) {
            const container = document.getElementById('otherDataList');
            const items = [
                ...Array.from(data.tokens).map(t => ({ name: 'Token', value: t })),
                ...Array.from(data.creditCards).map(c => ({ name: 'Credit Card', value: c })),
                ...data.others
            ];
            
            container.innerHTML = items.length > 0 
                ? items.map(i => `
                    <div class="data-card">
                        <strong>${i.name}:</strong> 
                        <span>${i.value}</span>
                    </div>
                `).join('')
                : '<div class="data-card">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© Ø£Ø®Ø±Ù‰</div>';
        }

        function deleteAllData() {
            document.cookie.split(';').forEach(cookie => {
                const [name] = cookie.split('=');
                document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
            });
            location.reload();
        }

        function showWarning(message) {
            document.getElementById('warningMessage').textContent = message;
        }
    </script>
</body>
</html>
